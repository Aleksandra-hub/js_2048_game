var t={};class e{static ROWS=4;static COLUMNS=4;static IDLE="idle";static PLAYING="playing";static WIN="win";static LOSE="lose";static getInitialStateDefault(){return[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}constructor(t=e.getInitialStateDefault()){this.setBoard=JSON.parse(JSON.stringify(t)),this.board=JSON.parse(JSON.stringify(t)),this.score=0,this.status=e.IDLE}moveLeft(){if(this.canMoveLeft()&&this.status===e.PLAYING){for(let t=0;t<e.ROWS;t++){let e=this.board[t];e=this.slide(e),this.board[t]=e}return this.setTwo(),this.checkLose(),this.checkWin(),!0}return!1}moveRight(){if(this.canMoveRight()&&this.status===e.PLAYING){for(let t=0;t<e.ROWS;t++){let e=this.board[t];e.reverse(),e=this.slide(e),this.board[t]=e.reverse()}return this.setTwo(),this.checkLose(),this.checkWin(),!0}return!1}moveUp(){if(this.canMoveUp()&&this.status===e.PLAYING){for(let t=0;t<e.COLUMNS;t++){let r=[this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]];r=this.slide(r);for(let s=0;s<e.ROWS;s++)this.board[s][t]=r[s]}return this.setTwo(),this.checkLose(),this.checkWin(),!0}return!1}moveDown(){if(this.canMoveDown()&&this.status===e.PLAYING){for(let t=0;t<e.COLUMNS;t++){let r=[this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]];r.reverse(),(r=this.slide(r)).reverse();for(let s=0;s<e.ROWS;s++)this.board[s][t]=r[s]}return this.setTwo(),this.checkLose(),this.checkWin(),!0}return!1}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.setTwo(),this.setTwo(),this.status=e.PLAYING}restart(){this.score=0,this.board=JSON.parse(JSON.stringify(this.setBoard)),this.status=e.IDLE}setTwo(){if(!this.hasEmptyTile())return;let t=!1,r=0,s=0,i=0;for(;!t;)r=Math.floor(Math.random()*e.ROWS),s=Math.floor(Math.random()*e.COLUMNS),0===this.board[r][s]&&(i=Math.random()>.1?2:4,this.board[r][s]=i,t=!0)}hasEmptyTile(){for(let t=0;t<e.ROWS;t++)for(let r=0;r<e.COLUMNS;r++)if(0===this.board[t][r])return!0;return!1}filterZero(t){return t.filter(t=>0!==t)}slide(t){let r=t;if(0===(r=this.filterZero(t)).length)return[0,0,0,0];for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,r[t+1]=0,this.score+=r[t]);for(r=this.filterZero(r);r.length<e.ROWS;)r.push(0);return r}checkWin(){for(let t=0;t<e.ROWS;t++)for(let r=0;r<e.COLUMNS;r++)2048===this.board[t][r]&&(this.status=e.WIN)}checkLose(){-1===[this.hasEmptyTile(),this.canMoveLeft(),this.canMoveRight(),this.canMoveUp(),this.canMoveDown()].indexOf(!0)&&(this.status=e.LOSE)}canMoveLeft(){for(let t=0;t<e.ROWS;t++){let e=Array.from(this.board[t]),r=this.canSlide(e);if(!this.isArrayTheSame(e,r))return!0}return!1}canMoveRight(){for(let t=0;t<e.ROWS;t++){let e=Array.from(this.board[t]),r=this.canSlide(e.reverse());if(!this.isArrayTheSame(e,r))return!0}return!1}canMoveUp(){for(let t=0;t<e.COLUMNS;t++){let e=Array.from([this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]]),r=this.canSlide([...e]);if(!this.isArrayTheSame(e,r))return!0}return!1}canMoveDown(){for(let t=0;t<e.COLUMNS;t++){let e=Array.from([this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]]),r=this.canSlide([...e].reverse()).reverse();if(!this.isArrayTheSame(e,r))return!0}return!1}isArrayTheSame(t,e){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}canSlide(t){let r=t;if(0===(r=this.filterZero(t)).length)return[0,0,0,0];for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,r[t+1]=0);for(r=this.filterZero(r);r.length<e.ROWS;)r.push(0);return r}}const r=new(t=e),s=document.querySelector(".button"),i=document.querySelector(".message-start"),o=document.querySelector(".message-win"),a=document.querySelector(".message-lose");function n(t,e){t.textContent="",t.classList.value="",t.classList.add("field-cell"),e>0&&(t.innerText=e.toString(),t.classList.add("field-cell--"+e.toString()))}function h(){for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.board[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}function l(){r.getStatus()===t.WIN&&o.classList.remove("hidden")}function c(){r.getStatus()===t.LOSE&&a.classList.remove("hidden")}s.onclick=function(){s.classList.contains("start")?(s.classList.remove("start"),s.classList.add("restart"),s.innerText="Restart",i.classList.add("hidden"),r.start(),function(){for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.setBoard[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}(),h()):s.classList.contains("restart")&&(s.classList.remove("restart"),s.classList.add("start"),s.innerText="Start",i.classList.remove("hidden"),r.restart(),document.querySelectorAll(".field-cell").forEach(t=>{t.innerText="",t.classList.value="",t.classList.add("field-cell")}),document.querySelector(".game-score").innerText="0",o.classList.contains("hidden")||document.querySelector(".message-win").classList.add("hidden"),a.classList.contains("hidden")||document.querySelector(".message-lose").classList.add("hidden"))},document.addEventListener("keyup",e=>{switch(e.code){case"ArrowLeft":(function(){if(r.moveLeft()){h(),l(),c();for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.board[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}})();break;case"ArrowRight":(function(){if(r.moveRight()){h(),l(),c();for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.board[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}})();break;case"ArrowUp":(function(){if(r.moveUp()){h(),l(),c();for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.board[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}})();break;case"ArrowDown":(function(){if(r.moveDown()){h(),l(),c();for(let e=0;e<t.ROWS;e++)for(let s=0;s<t.COLUMNS;s++){let t=r.board[e][s];n(document.getElementById(e.toString()+"-"+s.toString()),t)}}})()}document.querySelector(".game-score").innerText=r.getScore()});
//# sourceMappingURL=index.a66024fa.js.map
